require=function n(o,a,c){function l(t,e){if(!a[t]){if(!o[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(u)return u(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var s=a[t]={exports:{}};o[t][0].call(s.exports,function(e){return l(o[t][1][e]||e)},s,s.exports,n,o,a,c)}return a[t].exports}for(var u="function"==typeof require&&require,e=0;e<c.length;e++)l(c[e]);return l}({AudioMgr:[function(e,t,i){"use strict";cc._RF.push(t,"eef3d126HRNA76Vyq+jV4X4","AudioMgr");var r=e("Observer");cc.Class({extends:r,properties:{bgAudio:{displayName:"bgAudio",default:null,url:cc.AudioClip},famuAudio:{displayName:"famuAudio",default:null,url:cc.AudioClip},deathAudio:{displayName:"deathAudio",default:null,url:cc.AudioClip},_bgAudioId:null},_getMsgList:function(){return[]},_onMsg:function(e,t){},onLoad:function(){this._initMsg()},start:function(){},playBgAudio:function(){return null!==this._bgAudioId&&(cc.audioEngine.stop(this._bgAudioId),this._bgAudioId=null),this._bgAudioId=cc.audioEngine.play(this.bgAudio,!0,.5),this._bgAudioId},playFaMuAudio:function(){return cc.audioEngine.play(this.famuAudio,!1,1)},playDeathAudio:function(){return cc.audioEngine.play(this.deathAudio,!1,1)},stopBgAudio:function(){null!==this._bgAudioId&&(cc.audioEngine.stop(this._bgAudioId),this._bgAudioId=null),cc.audioEngine.stopAll()}}),cc._RF.pop()},{Observer:"Observer"}],MainSceneModule:[function(e,t,i){"use strict";cc._RF.push(t,"f0331kTbLJFD5E7gUIGS1Bl","MainSceneModule"),t.exports={status:{login:!0,main:!1,over:!1},playerDir:-1,tapStatus:!0,player:{dir:-1,leftPos:null,rightPos:null},tree:{width:null,height:null},score:0,bestScore:0,treeNum:7,time:5,totalTime:10,level:0,bgAudioId:null,resetTime:function(){return this.time=5,this.time},resetLevel:function(){this.level=0}},cc._RF.pop()},{}],MainScene:[function(e,t,i){"use strict";cc._RF.push(t,"8e176wwEsFMSb9IqwPGtdCS","MainScene");var r=e("Observer"),o=e("MainSceneModule");cc.Class({extends:r,properties:{treePre:{displayName:"treePre",default:null,type:cc.Prefab},treeLayer:{displayName:"treeLayer",default:null,type:cc.Node},loginUILayer:{displayName:"loginUILayer",default:null,type:cc.Node},mainUILayer:{displayName:"mainUILayer",default:null,type:cc.Node},overUILayer:{displayName:"overUILayer",default:null,type:cc.Node},spBaseTree:{displayName:"spBaseTree",default:null,type:cc.Sprite},spBg:{displayName:"spBg",default:null,type:cc.Sprite},spFlyTree:{displayName:"spFlyTree",default:null,type:cc.Sprite},spPlayer:{displayName:"spPlayer",default:null,type:cc.Sprite},touchLayer:{displayName:"touchLayer",default:null,type:cc.Node},tapLayout:{displayName:"tapLayout",default:null,type:cc.Node},spDie:{displayName:"spDie",default:null,type:cc.Sprite},spOverFrame:{displayName:"spOverFrame",default:null,type:cc.Sprite},lblScore:{displayName:"lblScore",default:null,type:cc.Label},lblFinalScore:{displayName:"lblFinalScore",default:null,type:cc.Label},spBestScore:{displayName:"spBestScore",default:null,type:cc.Sprite},spTime:{displayName:"spTime",default:null,type:cc.Sprite},spBird0:{displayName:"spBird0",default:null,type:cc.Sprite},spBird1:{displayName:"spBird1",default:null,type:cc.Sprite},spLevel:{displayName:"spLevel",default:null,type:cc.Sprite},lblLevel:{displayName:"lblLevel",default:null,type:cc.Label},audioMgr:{displayName:"audioMgr",default:null,type:cc.Node},_preDir:0},_getMsgList:function(){return[]},_onMsg:function(e,t){},_onError:function(e,t,i){},onLoad:function(){this._initAd(),this._initMsg(),this._resetStatus(),this._playBgAudio(),o.status&&this._initUI(),this._initView()},start:function(){},_resetStatus:function(){o.status.login=!0,o.status.main=!1,o.status.over=!1,o.score=0,o.bestScore=0},_initUI:function(){this.loginUILayer.active=o.status.login,this.mainUILayer.active=o.status.main,this.overUILayer.active=o.status.over,this.loginUILayer.active,this.mainUILayer.active&&(o.tapStatus=!0,this.tapLayout.active=o.tapStatus,this._initTouchLayer(),o.resetTime(),o.resetLevel(),this.spLevel.node.runAction(cc.hide()),this._initTimer(),o.score=0,this.spBestScore.node.active=!1,this._refreshScore(),this._playBirdFly()),this.overUILayer.active?(this.lblFinalScore.string=o.score,o.score>o.bestScore&&(this.spBestScore.node.active=!0,o.bestScore=o.score)):this.spOverFrame.node.y=cc.view.getVisibleSize().height},_initTree:function(){this._preDir=0;for(var e=[],t=0;t<o.treeNum;++t){var i=this._randDir();e.push(i)}this._treeArr=_.concat([0,0,0],e);for(var r=0;r<this._treeArr.length;++r)this._createTree(r,this._treeArr[r]);this.spFlyTree.node.y=this.spBaseTree.node.y+this.spBaseTree.node.height/2+this.spFlyTree.node.height/2},_initPlayer:function(){this.spPlayer.node.active=!0,o.player.leftPos=2*-this.spPlayer.node.width,o.player.rightPos=2*this.spPlayer.node.width,-1===o.player.dir?(this.spPlayer.node.scaleX=1,this.spPlayer.node.x=o.player.leftPos):1===o.player.dir&&(this.spPlayer.node.scaleX=-1,this.spPlayer.node.x=o.player.rightPos),this.spDie.node.active=!1},_initView:function(){this._initTree(),this._initPlayer()},_randDir:function(){var e=null;return e=0===this._preDir?_.sample([-1,0,1]):0,this._preDir=e},_createTree:function(e,t){var i=cc.instantiate(this.treePre);this.treeLayer.addChild(i),i.y=this.spBaseTree.node.y+this.spBaseTree.node.height/2+i.height/2+i.height*e,i.getComponent("Tree").initTree(t),o.tree.height=i.height,o.tree.width=i.width},onBtnClickToStart:function(){o.status.login=!1,o.status.main=!0,o.status.over=!1,this._initUI()},onBtnClickToRestart:function(){this.onBtnClickToStart(),this.treeLayer.destroyAllChildren(),this._initView(),this._playBgAudio()},_initTouchLayer:function(){this.touchLayer.active&&(this.touchLayer.on("touchstart",function(e){},this),this.touchLayer.on("touchend",this._changePlayerPos,this),this.touchLayer.on("touchcancel",this._changePlayerPos,this))},_movePlayer:function(e,t){-1===t?this.spPlayer.node.scaleX=1:1===t&&(this.spPlayer.node.scaleX=-1),this.spPlayer.node.x=o.player[e],t===_.head(this._treeArr)?this._showGameOver():this._addTree(t)},_addTree:function(e){var t=this.treeLayer.children.length,i=this._randDir();this._treeArr.push(i),this._createTree(t,i),this._moveDown(),this._flyAway(e),this._checkGameOver(e),this._addTime(),this._playFaMuAudio()},_moveDown:function(){this.treeLayer.children[0].removeFromParent(!0);for(var e=0;e<this.treeLayer.children.length;++e){var t=cc.moveBy(.2,cc.p(0,-o.tree.height));this.treeLayer.children[e].runAction(t)}},_flyAway:function(e){var t=this._treeArr.shift();this._createFlyTree(0,t,e)},_createFlyTree:function(e,t,i){var r=cc.instantiate(this.treePre);this.spBg.node.addChild(r),r.y=this.spBaseTree.node.y+this.spBaseTree.node.height/2+r.height/2+r.height*e,r.getComponent("Tree").flyTree(t,i)},_offTouchLayer:function(){this.touchLayer.off("touchend",this._changePlayerPos,this),this.touchLayer.off("touchcancel",this._changePlayerPos,this)},_showGameOver:function(){this._stopBgAudio(),this._playDeathAudio(),this._offTouchLayer(),this.spDie.node.active=!0,this.spPlayer.node.x<0?this.spDie.node.x=-this.spBaseTree.node.width:this.spDie.node.x=this.spBaseTree.node.width,this.spPlayer.node.active=!1,o.status.over=!0,o.status.main=!1,o.status.login=!1,this._initUI();var e=cc.view.getVisibleSize().height/2-this.spOverFrame.node.height/2,t=cc.moveTo(.5,cc.p(0,e));this.spOverFrame.node.runAction(t),this.unschedule(this._countDown),this.showAd36153()},_changePlayerPos:function(e){o.tapStatus&&(o.tapStatus=!1,this.tapLayout.active=o.tapStatus,this.schedule(this._countDown,1));var t=cc.view.getVisibleSize().width;e.getLocationX()<t/2?this._movePlayer("leftPos",-1):this._movePlayer("rightPos",1),this._playChop("chop")},_checkGameOver:function(e){e===_.head(this._treeArr)?this._showGameOver():(o.score++,this._refreshScore())},_refreshScore:function(){this.lblScore.string=o.score;var e=parseInt(o.score/20);if(o.score%20==0&&0!==o.score){this.lblLevel.string=e;var t=cc.show(),i=cc.hide(),r=cc.moveBy(.5,cc.p(0,2*this.spLevel.node.height)),s=cc.moveBy(.01,cc.p(0,2*-this.spLevel.node.height)),n=cc.delayTime(1);this.spLevel.node.runAction(cc.sequence(t,n,r,i,s))}},_playChop:function(e){this.spPlayer.node.getComponent(cc.Animation).play(e)},_countDown:function(){o.time--,o.time<=0&&this._showGameOver(),this._initTimer()},_addTime:function(){o.time++,10<=o.time&&(o.time=10),this._initTimer()},_initTimer:function(){var e=this.spTime.fillStart;e=o.time/o.totalTime,this.spTime.fillStart=e},_playBirdFly:function(){var e=cc.view.getVisibleSize().width,t=cc.view.getVisibleSize().height/2,i=-e,r=-.9*e,s=.5*t,n=.65*t;this.spBird0.node.position=cc.p(i,s),this.spBird1.node.position=cc.p(r,n);var o=cc.moveBy(20,cc.p(3*e,0)),a=cc.moveBy(20,cc.p(3*e,0)),c=cc.place(cc.p(i,s)),l=cc.place(cc.p(r,n));this.spBird0.node.runAction(cc.repeatForever(cc.sequence(o,c))),this.spBird1.node.runAction(cc.repeatForever(cc.sequence(a,l)))},_playBgAudio:function(){this.audioMgr.getComponent("AudioMgr").playBgAudio()},_playFaMuAudio:function(){this.audioMgr.getComponent("AudioMgr").playFaMuAudio()},_playDeathAudio:function(){this.audioMgr.getComponent("AudioMgr").playDeathAudio()},_stopBgAudio:function(){this.audioMgr.getComponent("AudioMgr").stopBgAudio()},_initAd:function(){window.Vijs&&(window.myAd36153=Vijs.setAD({unitid:36153,loadedCallback:function(){console.log("load success")},rewardedCallback:function(e,t){console.log(t)}}))},showAd36153:function(){window.myAd36153&&window.myAd36153.show()}}),cc._RF.pop()},{MainSceneModule:"MainSceneModule",Observer:"Observer"}],ObserverMgr:[function(e,t,i){"use strict";cc._RF.push(t,"5ec06xnS8JPTaTe2UIVevs0","ObserverMgr"),t.exports={obsArray:{},addEventListener:function(e,t,i){void 0===i&&console.log("[ObserverMgr] 注册消息 [%s]:%s 的作用于未定义",e,t.name),void 0===this.obsArray[e]&&(this.obsArray[e]=[]);for(var r=0;r<this.obsArray[e].length;r++){var s=this.obsArray[e][r];if(s.func===t&&s.ob===i)return}this.obsArray[e].push({func:t,ob:i})},removeEventListener:function(e,t,i){var r=!1,s=this.obsArray[e];if(s)for(var n=0;n<s.length;){var o=s[n],a=o.func,c=o.ob;t===a&&i===c?(s.splice(n,1),r=!0):n++}return r},removeEventListenerWithObject:function(e){for(var t in this.obsArray)for(var i=this.obsArray[t],r=0;r<i.length;){i[r].ob===e?i.splice(r,1):r++}},cleanAllEventListener:function(){this.obsArray={}},dispatchMsg:function(e,t){var i=this.obsArray[e];if(void 0!==i)for(var r=0;r<i.length;r++){var s=i[r],n=s.func,o=s.ob;n&&o&&n.apply(o,[e,t])}else console.log("消息列表中不存在: "+e)}},cc._RF.pop()},{}],Observer:[function(e,t,i){"use strict";cc._RF.push(t,"9d765qOaZlCFbUPyazjZWcf","Observer");var r=e("ObserverMgr");cc.Class({extends:cc.Component,_initMsg:function(){for(var e=this._getMsgList(),t=0;t<e.length;t++){var i=e[t];r.addEventListener(i,this._onMsg,this)}},onLoad:function(){},_getMsgList:function(){return[]},_onMsg:function(e,t){},_onError:function(e,t,i){},_onNetOpen:function(){},_onErrorDeal:function(e,t){var i=t[0],r=t[1],s=t[2];this._onError(i,r,s)},onDisable:function(){r.removeEventListenerWithObject(this)},onEnable:function(){},onDestroy:function(){r.removeEventListenerWithObject(this)}}),cc._RF.pop()},{ObserverMgr:"ObserverMgr"}],Tree:[function(e,t,i){"use strict";cc._RF.push(t,"3bd33ev8GdPUbtuMKSUTztq","Tree");var r=e("Observer"),a=e("MainSceneModule");cc.Class({extends:r,properties:{spTree:{displayName:"spTree",default:null,type:cc.Sprite},spLeftBranch:{displayName:"spLeftBranch",default:null,type:cc.Sprite},spRightBranch:{displayName:"spRightBranch",default:null,type:cc.Sprite}},_getMsgList:function(){return[]},_onMsg:function(e,t){},onLoad:function(){this._initMsg()},start:function(){},initTree:function(e){0===e?(this.spLeftBranch.node.active=!1,this.spRightBranch.node.active=!1):-1===e?(this.spLeftBranch.node.active=!0,this.spRightBranch.node.active=!1):1===e&&(this.spLeftBranch.node.active=!1,this.spRightBranch.node.active=!0)},flyTree:function(e,t){this.initTree(e);var i,r=null,s=null,n=cc.view.getVisibleSize().width/2+a.tree.width;1===t?(r=cc.moveBy(.2,cc.p(-n,0)),s=cc.rotateBy(.2,-360)):-1===t&&(r=cc.moveBy(.2,cc.p(n,0)),s=cc.rotateBy(.2,360)),i=cc.spawn(r,s);var o=cc.removeSelf(!0);this.node.runAction(cc.sequence(i,o))}}),cc._RF.pop()},{MainSceneModule:"MainSceneModule",Observer:"Observer"}]},{},["Observer","ObserverMgr","AudioMgr","MainScene","MainSceneModule","Tree"]);